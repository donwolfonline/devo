/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/[...nextauth]/route";
exports.ids = ["app/api/auth/[...nextauth]/route"];
exports.modules = {

/***/ "mongoose":
/*!***************************!*\
  !*** external "mongoose" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("mongoose");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("querystring");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=%2FUsers%2Ffrederickdineen%2FDesktop%2Fdevoapp%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ffrederickdineen%2FDesktop%2Fdevoapp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=%2FUsers%2Ffrederickdineen%2FDesktop%2Fdevoapp%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ffrederickdineen%2FDesktop%2Fdevoapp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_frederickdineen_Desktop_devoapp_src_app_api_auth_nextauth_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/auth/[...nextauth]/route.ts */ \"(rsc)/./src/app/api/auth/[...nextauth]/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/[...nextauth]/route\",\n        pathname: \"/api/auth/[...nextauth]\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/[...nextauth]/route\"\n    },\n    resolvedPagePath: \"/Users/frederickdineen/Desktop/devoapp/src/app/api/auth/[...nextauth]/route.ts\",\n    nextConfigOutput,\n    userland: _Users_frederickdineen_Desktop_devoapp_src_app_api_auth_nextauth_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGJTVCLi4ubmV4dGF1dGglNUQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF1dGglMkYlNUIuLi5uZXh0YXV0aCU1RCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkYlNUIuLi5uZXh0YXV0aCU1RCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmZyZWRlcmlja2RpbmVlbiUyRkRlc2t0b3AlMkZkZXZvYXBwJTJGc3JjJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmZyZWRlcmlja2RpbmVlbiUyRkRlc2t0b3AlMkZkZXZvYXBwJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUErRjtBQUN2QztBQUNxQjtBQUM4QjtBQUMzRztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseUdBQW1CO0FBQzNDO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHNEQUFzRDtBQUM5RDtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUMwRjs7QUFFMUYiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL2ZyZWRlcmlja2RpbmVlbi9EZXNrdG9wL2Rldm9hcHAvc3JjL2FwcC9hcGkvYXV0aC9bLi4ubmV4dGF1dGhdL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hdXRoL1suLi5uZXh0YXV0aF0vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9hdXRoL1suLi5uZXh0YXV0aF1cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy9mcmVkZXJpY2tkaW5lZW4vRGVza3RvcC9kZXZvYXBwL3NyYy9hcHAvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHdvcmtBc3luY1N0b3JhZ2UsXG4gICAgICAgIHdvcmtVbml0QXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=%2FUsers%2Ffrederickdineen%2FDesktop%2Fdevoapp%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ffrederickdineen%2FDesktop%2Fdevoapp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/auth/[...nextauth]/route.ts":
/*!*************************************************!*\
  !*** ./src/app/api/auth/[...nextauth]/route.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ handler),\n/* harmony export */   POST: () => (/* binding */ handler),\n/* harmony export */   authOptions: () => (/* binding */ authOptions)\n/* harmony export */ });\n/* harmony import */ var next_auth_next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/next */ \"(rsc)/./node_modules/next-auth/next/index.js\");\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/providers/credentials */ \"(rsc)/./node_modules/next-auth/providers/credentials.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _lib_mongodb__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/mongodb */ \"(rsc)/./src/lib/mongodb.ts\");\n/* harmony import */ var _models_User__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/models/User */ \"(rsc)/./src/models/User.ts\");\n/* harmony import */ var _models_Log__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/models/Log */ \"(rsc)/./src/models/Log.ts\");\n\n\n\n\n\n\nconst authOptions = {\n    providers: [\n        (0,next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n            id: 'credentials',\n            name: \"Credentials\",\n            credentials: {\n                username: {\n                    label: \"Username or Email\",\n                    type: \"text\"\n                },\n                password: {\n                    label: \"Password\",\n                    type: \"password\"\n                },\n                type: {\n                    label: \"Login Type\",\n                    type: \"text\"\n                }\n            },\n            async authorize (credentials) {\n                try {\n                    if (!credentials?.username || !credentials?.password) {\n                        // Log failed login attempt\n                        await _models_Log__WEBPACK_IMPORTED_MODULE_5__[\"default\"].create({\n                            type: 'LOGIN',\n                            message: 'Login attempt with missing credentials',\n                            metadata: {\n                                username: credentials?.username\n                            }\n                        });\n                        throw new Error('Please enter your username/email and password');\n                    }\n                    // Connect to database\n                    await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_3__.connectDB)();\n                    // Find user by username or email (case-insensitive)\n                    const user = await _models_User__WEBPACK_IMPORTED_MODULE_4__[\"default\"].findOne({\n                        $or: [\n                            {\n                                email: credentials.username.toLowerCase()\n                            },\n                            {\n                                username: credentials.username.toLowerCase()\n                            }\n                        ]\n                    }).select('+password');\n                    // Check if user exists\n                    if (!user) {\n                        // Log failed login attempt\n                        await _models_Log__WEBPACK_IMPORTED_MODULE_5__[\"default\"].create({\n                            type: 'LOGIN',\n                            message: `Failed login attempt: User not found (${credentials.username})`,\n                            metadata: {\n                                username: credentials.username\n                            }\n                        });\n                        throw new Error('User not found');\n                    }\n                    // Check if account is locked\n                    if (user.isLockedOut) {\n                        // Log locked account login attempt\n                        await _models_Log__WEBPACK_IMPORTED_MODULE_5__[\"default\"].create({\n                            type: 'LOGIN',\n                            message: 'Login attempt on locked account',\n                            userId: user._id,\n                            metadata: {\n                                username: user.username\n                            }\n                        });\n                        throw new Error('Account is temporarily locked. Please try again later.');\n                    }\n                    // Verify password\n                    const isValidPassword = await (0,bcryptjs__WEBPACK_IMPORTED_MODULE_2__.compare)(credentials.password, user.password);\n                    if (!isValidPassword) {\n                        // Log failed password attempt\n                        await _models_Log__WEBPACK_IMPORTED_MODULE_5__[\"default\"].create({\n                            type: 'LOGIN',\n                            message: `Failed login attempt: Invalid password (${credentials.username})`,\n                            userId: user._id,\n                            metadata: {\n                                username: credentials.username\n                            }\n                        });\n                        // Increment failed login attempts\n                        user.failedLoginAttempts = (user.failedLoginAttempts || 0) + 1;\n                        // Lock account after 5 failed attempts\n                        if (user.failedLoginAttempts >= 5) {\n                            user.isLockedOut = true;\n                            user.lockoutTime = new Date(Date.now() + 15 * 60 * 1000); // 15 minutes\n                        }\n                        await user.save();\n                        throw new Error('Invalid credentials');\n                    }\n                    // Reset failed login attempts on successful login\n                    user.failedLoginAttempts = 0;\n                    user.isLockedOut = false;\n                    user.lastLogin = new Date();\n                    await user.save();\n                    // Log successful login\n                    await _models_Log__WEBPACK_IMPORTED_MODULE_5__[\"default\"].create({\n                        type: 'LOGIN',\n                        message: 'User logged in successfully',\n                        userId: user._id,\n                        metadata: {\n                            username: user.username\n                        }\n                    });\n                    return {\n                        id: user._id.toString(),\n                        name: user.name || user.username,\n                        email: user.email,\n                        role: user.role,\n                        username: user.username,\n                        image: user.image\n                    };\n                } catch (error) {\n                    console.error('Login Error:', error);\n                    // Log any unexpected errors\n                    await _models_Log__WEBPACK_IMPORTED_MODULE_5__[\"default\"].create({\n                        type: 'LOGIN',\n                        message: 'Unexpected login error',\n                        metadata: {\n                            error: error.message,\n                            username: credentials?.username\n                        }\n                    });\n                    throw error;\n                }\n            }\n        })\n    ],\n    callbacks: {\n        async jwt ({ token, user, account, trigger }) {\n            if (user) {\n                token.id = user.id;\n                token.role = user.role;\n                token.username = user.username;\n            }\n            return token;\n        },\n        async session ({ session, token }) {\n            if (token) {\n                session.user = {\n                    ...session.user,\n                    id: token.id,\n                    role: token.role,\n                    username: token.username\n                };\n            }\n            return session;\n        }\n    },\n    pages: {\n        signIn: '/auth/sign-in',\n        error: '/auth/sign-in'\n    },\n    session: {\n        strategy: 'jwt',\n        maxAge: 30 * 24 * 60 * 60\n    },\n    jwt: {\n        maxAge: 30 * 24 * 60 * 60\n    },\n    secret: \"your-super-secret-key-here\",\n    debug: \"development\" === 'development'\n};\nconst handler = (0,next_auth_next__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(authOptions);\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hdXRoL1suLi5uZXh0YXV0aF0vcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFzQztBQUU0QjtBQUMvQjtBQUNPO0FBQ1Q7QUFDRjtBQXdCeEIsTUFBTU0sY0FBK0I7SUFDMUNDLFdBQVc7UUFDVE4sMkVBQW1CQSxDQUFDO1lBQ2xCTyxJQUFJO1lBQ0pDLE1BQU07WUFDTkMsYUFBYTtnQkFDWEMsVUFBVTtvQkFBRUMsT0FBTztvQkFBcUJDLE1BQU07Z0JBQU87Z0JBQ3JEQyxVQUFVO29CQUFFRixPQUFPO29CQUFZQyxNQUFNO2dCQUFXO2dCQUNoREEsTUFBTTtvQkFBRUQsT0FBTztvQkFBY0MsTUFBTTtnQkFBTztZQUM1QztZQUNBLE1BQU1FLFdBQVVMLFdBQVc7Z0JBQ3pCLElBQUk7b0JBQ0YsSUFBSSxDQUFDQSxhQUFhQyxZQUFZLENBQUNELGFBQWFJLFVBQVU7d0JBQ3BELDJCQUEyQjt3QkFDM0IsTUFBTVQsbURBQUdBLENBQUNXLE1BQU0sQ0FBQzs0QkFDZkgsTUFBTTs0QkFDTkksU0FBUzs0QkFDVEMsVUFBVTtnQ0FBRVAsVUFBVUQsYUFBYUM7NEJBQVM7d0JBQzlDO3dCQUNBLE1BQU0sSUFBSVEsTUFBTTtvQkFDbEI7b0JBRUEsc0JBQXNCO29CQUN0QixNQUFNaEIsdURBQVNBO29CQUVmLG9EQUFvRDtvQkFDcEQsTUFBTWlCLE9BQU8sTUFBTWhCLG9EQUFJQSxDQUFDaUIsT0FBTyxDQUFDO3dCQUM5QkMsS0FBSzs0QkFDSDtnQ0FBRUMsT0FBT2IsWUFBWUMsUUFBUSxDQUFDYSxXQUFXOzRCQUFHOzRCQUM1QztnQ0FBRWIsVUFBVUQsWUFBWUMsUUFBUSxDQUFDYSxXQUFXOzRCQUFHO3lCQUNoRDtvQkFDSCxHQUFHQyxNQUFNLENBQUM7b0JBRVYsdUJBQXVCO29CQUN2QixJQUFJLENBQUNMLE1BQU07d0JBQ1QsMkJBQTJCO3dCQUMzQixNQUFNZixtREFBR0EsQ0FBQ1csTUFBTSxDQUFDOzRCQUNmSCxN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LElBQUk7Z0JBQ3RCTSxNQUFNaEMsUUFBUSxHQUFHUyxLQUFLVCxRQUFRO1lBQ2hDO1lBQ0EsT0FBT2dDO1FBQ1Q7UUFDQSxNQUFNRyxTQUFRLEVBQUVBLE9BQU8sRUFBRUgsS0FBSyxFQUFFO1lBQzlCLElBQUlBLE9BQU87Z0JBQ1RHLFFBQVExQixJQUFJLEdBQUc7b0JBQ2IsR0FBRzBCLFFBQVExQixJQUFJO29CQUNmWixJQUFJbUMsTUFBTW5DLEVBQUU7b0JBQ1o2QixNQUFNTSxNQUFNTixJQUFJO29CQUNoQjFCLFVBQVVnQyxNQUFNaEMsUUFBUTtnQkFDMUI7WUFDRjtZQUNBLE9BQU9tQztRQUNUO0lBQ0Y7SUFDQUMsT0FBTztRQUNMQyxRQUFRO1FBQ1JULE9BQU87SUFDVDtJQUNBTyxTQUFTO1FBQ1BHLFVBQVU7UUFDVkMsUUFBUSxLQUFLLEtBQUssS0FBSztJQUN6QjtJQUNBUixLQUFLO1FBQ0hRLFFBQVEsS0FBSyxLQUFLLEtBQUs7SUFDekI7SUFDQUMsUUFBUUMsNEJBQTJCO0lBQ25DRyxPQUFPSCxrQkFBeUI7QUFDbEMsRUFBRTtBQUVGLE1BQU1JLFVBQVV4RCwwREFBUUEsQ0FBQ007QUFDa0IiLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmVkZXJpY2tkaW5lZW4vRGVza3RvcC9kZXZvYXBwL3NyYy9hcHAvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTmV4dEF1dGggZnJvbSBcIm5leHQtYXV0aC9uZXh0XCI7XG5pbXBvcnQgeyBOZXh0QXV0aE9wdGlvbnMgfSBmcm9tIFwibmV4dC1hdXRoXCI7XG5pbXBvcnQgQ3JlZGVudGlhbHNQcm92aWRlciBmcm9tIFwibmV4dC1hdXRoL3Byb3ZpZGVycy9jcmVkZW50aWFsc1wiO1xuaW1wb3J0IHsgY29tcGFyZSB9IGZyb20gXCJiY3J5cHRqc1wiO1xuaW1wb3J0IHsgY29ubmVjdERCIH0gZnJvbSBcIkAvbGliL21vbmdvZGJcIjtcbmltcG9ydCBVc2VyIGZyb20gXCJAL21vZGVscy9Vc2VyXCI7XG5pbXBvcnQgTG9nIGZyb20gXCJAL21vZGVscy9Mb2dcIjtcblxuLy8gRXh0ZW5kIHRoZSBkZWZhdWx0IHNlc3Npb24gdHlwZXNcbmRlY2xhcmUgbW9kdWxlIFwibmV4dC1hdXRoXCIge1xuICBpbnRlcmZhY2UgU2Vzc2lvbiB7XG4gICAgdXNlcjoge1xuICAgICAgaWQ6IHN0cmluZztcbiAgICAgIG5hbWU/OiBzdHJpbmcgfCBudWxsO1xuICAgICAgZW1haWw/OiBzdHJpbmcgfCBudWxsO1xuICAgICAgaW1hZ2U/OiBzdHJpbmcgfCBudWxsO1xuICAgICAgcm9sZTogc3RyaW5nO1xuICAgICAgdXNlcm5hbWU6IHN0cmluZztcbiAgICB9XG4gIH1cbiAgaW50ZXJmYWNlIFVzZXIge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgbmFtZT86IHN0cmluZyB8IG51bGw7XG4gICAgZW1haWw/OiBzdHJpbmcgfCBudWxsO1xuICAgIGltYWdlPzogc3RyaW5nIHwgbnVsbDtcbiAgICByb2xlOiBzdHJpbmc7XG4gICAgdXNlcm5hbWU6IHN0cmluZztcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgYXV0aE9wdGlvbnM6IE5leHRBdXRoT3B0aW9ucyA9IHtcbiAgcHJvdmlkZXJzOiBbXG4gICAgQ3JlZGVudGlhbHNQcm92aWRlcih7XG4gICAgICBpZDogJ2NyZWRlbnRpYWxzJyxcbiAgICAgIG5hbWU6IFwiQ3JlZGVudGlhbHNcIixcbiAgICAgIGNyZWRlbnRpYWxzOiB7XG4gICAgICAgIHVzZXJuYW1lOiB7IGxhYmVsOiBcIlVzZXJuYW1lIG9yIEVtYWlsXCIsIHR5cGU6IFwidGV4dFwiIH0sXG4gICAgICAgIHBhc3N3b3JkOiB7IGxhYmVsOiBcIlBhc3N3b3JkXCIsIHR5cGU6IFwicGFzc3dvcmRcIiB9LFxuICAgICAgICB0eXBlOiB7IGxhYmVsOiBcIkxvZ2luIFR5cGVcIiwgdHlwZTogXCJ0ZXh0XCIgfVxuICAgICAgfSxcbiAgICAgIGFzeW5jIGF1dGhvcml6ZShjcmVkZW50aWFscykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGlmICghY3JlZGVudGlhbHM/LnVzZXJuYW1lIHx8ICFjcmVkZW50aWFscz8ucGFzc3dvcmQpIHtcbiAgICAgICAgICAgIC8vIExvZyBmYWlsZWQgbG9naW4gYXR0ZW1wdFxuICAgICAgICAgICAgYXdhaXQgTG9nLmNyZWF0ZSh7XG4gICAgICAgICAgICAgIHR5cGU6ICdMT0dJTicsXG4gICAgICAgICAgICAgIG1lc3NhZ2U6ICdMb2dpbiBhdHRlbXB0IHdpdGggbWlzc2luZyBjcmVkZW50aWFscycsXG4gICAgICAgICAgICAgIG1ldGFkYXRhOiB7IHVzZXJuYW1lOiBjcmVkZW50aWFscz8udXNlcm5hbWUgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1BsZWFzZSBlbnRlciB5b3VyIHVzZXJuYW1lL2VtYWlsIGFuZCBwYXNzd29yZCcpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIENvbm5lY3QgdG8gZGF0YWJhc2VcbiAgICAgICAgICBhd2FpdCBjb25uZWN0REIoKTtcblxuICAgICAgICAgIC8vIEZpbmQgdXNlciBieSB1c2VybmFtZSBvciBlbWFpbCAoY2FzZS1pbnNlbnNpdGl2ZSlcbiAgICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kT25lKHtcbiAgICAgICAgICAgICRvcjogW1xuICAgICAgICAgICAgICB7IGVtYWlsOiBjcmVkZW50aWFscy51c2VybmFtZS50b0xvd2VyQ2FzZSgpIH0sXG4gICAgICAgICAgICAgIHsgdXNlcm5hbWU6IGNyZWRlbnRpYWxzLnVzZXJuYW1lLnRvTG93ZXJDYXNlKCkgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH0pLnNlbGVjdCgnK3Bhc3N3b3JkJyk7XG5cbiAgICAgICAgICAvLyBDaGVjayBpZiB1c2VyIGV4aXN0c1xuICAgICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgICAgLy8gTG9nIGZhaWxlZCBsb2dpbiBhdHRlbXB0XG4gICAgICAgICAgICBhd2FpdCBMb2cuY3JlYXRlKHtcbiAgICAgICAgICAgICAgdHlwZTogJ0xPR0lOJyxcbiAgICAgICAgICAgICAgbWVzc2FnZTogYEZhaWxlZCBsb2dpbiBhdHRlbXB0OiBVc2VyIG5vdCBmb3VuZCAoJHtjcmVkZW50aWFscy51c2VybmFtZX0pYCxcbiAgICAgICAgICAgICAgbWV0YWRhdGE6IHsgdXNlcm5hbWU6IGNyZWRlbnRpYWxzLnVzZXJuYW1lIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVc2VyIG5vdCBmb3VuZCcpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIENoZWNrIGlmIGFjY291bnQgaXMgbG9ja2VkXG4gICAgICAgICAgaWYgKHVzZXIuaXNMb2NrZWRPdXQpIHtcbiAgICAgICAgICAgIC8vIExvZyBsb2NrZWQgYWNjb3VudCBsb2dpbiBhdHRlbXB0XG4gICAgICAgICAgICBhd2FpdCBMb2cuY3JlYXRlKHtcbiAgICAgICAgICAgICAgdHlwZTogJ0xPR0lOJyxcbiAgICAgICAgICAgICAgbWVzc2FnZTogJ0xvZ2luIGF0dGVtcHQgb24gbG9ja2VkIGFjY291bnQnLFxuICAgICAgICAgICAgICB1c2VySWQ6IHVzZXIuX2lkLFxuICAgICAgICAgICAgICBtZXRhZGF0YTogeyB1c2VybmFtZTogdXNlci51c2VybmFtZSB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQWNjb3VudCBpcyB0ZW1wb3JhcmlseSBsb2NrZWQuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gVmVyaWZ5IHBhc3N3b3JkXG4gICAgICAgICAgY29uc3QgaXNWYWxpZFBhc3N3b3JkID0gYXdhaXQgY29tcGFyZShcbiAgICAgICAgICAgIGNyZWRlbnRpYWxzLnBhc3N3b3JkLCBcbiAgICAgICAgICAgIHVzZXIucGFzc3dvcmRcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgaWYgKCFpc1ZhbGlkUGFzc3dvcmQpIHtcbiAgICAgICAgICAgIC8vIExvZyBmYWlsZWQgcGFzc3dvcmQgYXR0ZW1wdFxuICAgICAgICAgICAgYXdhaXQgTG9nLmNyZWF0ZSh7XG4gICAgICAgICAgICAgIHR5cGU6ICdMT0dJTicsXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IGBGYWlsZWQgbG9naW4gYXR0ZW1wdDogSW52YWxpZCBwYXNzd29yZCAoJHtjcmVkZW50aWFscy51c2VybmFtZX0pYCxcbiAgICAgICAgICAgICAgdXNlcklkOiB1c2VyLl9pZCxcbiAgICAgICAgICAgICAgbWV0YWRhdGE6IHsgdXNlcm5hbWU6IGNyZWRlbnRpYWxzLnVzZXJuYW1lIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBJbmNyZW1lbnQgZmFpbGVkIGxvZ2luIGF0dGVtcHRzXG4gICAgICAgICAgICB1c2VyLmZhaWxlZExvZ2luQXR0ZW1wdHMgPSAodXNlci5mYWlsZWRMb2dpbkF0dGVtcHRzIHx8IDApICsgMTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gTG9jayBhY2NvdW50IGFmdGVyIDUgZmFpbGVkIGF0dGVtcHRzXG4gICAgICAgICAgICBpZiAodXNlci5mYWlsZWRMb2dpbkF0dGVtcHRzID49IDUpIHtcbiAgICAgICAgICAgICAgdXNlci5pc0xvY2tlZE91dCA9IHRydWU7XG4gICAgICAgICAgICAgIHVzZXIubG9ja291dFRpbWUgPSBuZXcgRGF0ZShEYXRlLm5vdygpICsgMTUgKiA2MCAqIDEwMDApOyAvLyAxNSBtaW51dGVzXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGF3YWl0IHVzZXIuc2F2ZSgpO1xuXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgY3JlZGVudGlhbHMnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBSZXNldCBmYWlsZWQgbG9naW4gYXR0ZW1wdHMgb24gc3VjY2Vzc2Z1bCBsb2dpblxuICAgICAgICAgIHVzZXIuZmFpbGVkTG9naW5BdHRlbXB0cyA9IDA7XG4gICAgICAgICAgdXNlci5pc0xvY2tlZE91dCA9IGZhbHNlO1xuICAgICAgICAgIHVzZXIubGFzdExvZ2luID0gbmV3IERhdGUoKTtcbiAgICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcblxuICAgICAgICAgIC8vIExvZyBzdWNjZXNzZnVsIGxvZ2luXG4gICAgICAgICAgYXdhaXQgTG9nLmNyZWF0ZSh7XG4gICAgICAgICAgICB0eXBlOiAnTE9HSU4nLFxuICAgICAgICAgICAgbWVzc2FnZTogJ1VzZXIgbG9nZ2VkIGluIHN1Y2Nlc3NmdWxseScsXG4gICAgICAgICAgICB1c2VySWQ6IHVzZXIuX2lkLFxuICAgICAgICAgICAgbWV0YWRhdGE6IHsgdXNlcm5hbWU6IHVzZXIudXNlcm5hbWUgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiB1c2VyLl9pZC50b1N0cmluZygpLFxuICAgICAgICAgICAgbmFtZTogdXNlci5uYW1lIHx8IHVzZXIudXNlcm5hbWUsXG4gICAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICAgIHJvbGU6IHVzZXIucm9sZSxcbiAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VyLnVzZXJuYW1lLFxuICAgICAgICAgICAgaW1hZ2U6IHVzZXIuaW1hZ2VcbiAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignTG9naW4gRXJyb3I6JywgZXJyb3IpO1xuXG4gICAgICAgICAgLy8gTG9nIGFueSB1bmV4cGVjdGVkIGVycm9yc1xuICAgICAgICAgIGF3YWl0IExvZy5jcmVhdGUoe1xuICAgICAgICAgICAgdHlwZTogJ0xPR0lOJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdVbmV4cGVjdGVkIGxvZ2luIGVycm9yJyxcbiAgICAgICAgICAgIG1ldGFkYXRhOiB7IFxuICAgICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICAgICAgdXNlcm5hbWU6IGNyZWRlbnRpYWxzPy51c2VybmFtZSBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgXSxcbiAgY2FsbGJhY2tzOiB7XG4gICAgYXN5bmMgand0KHsgdG9rZW4sIHVzZXIsIGFjY291bnQsIHRyaWdnZXIgfSkge1xuICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgdG9rZW4uaWQgPSB1c2VyLmlkO1xuICAgICAgICB0b2tlbi5yb2xlID0gdXNlci5yb2xlO1xuICAgICAgICB0b2tlbi51c2VybmFtZSA9IHVzZXIudXNlcm5hbWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gdG9rZW47XG4gICAgfSxcbiAgICBhc3luYyBzZXNzaW9uKHsgc2Vzc2lvbiwgdG9rZW4gfSkge1xuICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgIHNlc3Npb24udXNlciA9IHtcbiAgICAgICAgICAuLi5zZXNzaW9uLnVzZXIsXG4gICAgICAgICAgaWQ6IHRva2VuLmlkIGFzIHN0cmluZyxcbiAgICAgICAgICByb2xlOiB0b2tlbi5yb2xlIGFzIHN0cmluZyxcbiAgICAgICAgICB1c2VybmFtZTogdG9rZW4udXNlcm5hbWUgYXMgc3RyaW5nXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4gc2Vzc2lvbjtcbiAgICB9XG4gIH0sXG4gIHBhZ2VzOiB7XG4gICAgc2lnbkluOiAnL2F1dGgvc2lnbi1pbicsXG4gICAgZXJyb3I6ICcvYXV0aC9zaWduLWluJ1xuICB9LFxuICBzZXNzaW9uOiB7XG4gICAgc3RyYXRlZ3k6ICdqd3QnLFxuICAgIG1heEFnZTogMzAgKiAyNCAqIDYwICogNjAsIC8vIDMwIGRheXNcbiAgfSxcbiAgand0OiB7XG4gICAgbWF4QWdlOiAzMCAqIDI0ICogNjAgKiA2MCwgLy8gMzAgZGF5c1xuICB9LFxuICBzZWNyZXQ6IHByb2Nlc3MuZW52Lk5FWFRBVVRIX1NFQ1JFVCxcbiAgZGVidWc6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnLFxufTtcblxuY29uc3QgaGFuZGxlciA9IE5leHRBdXRoKGF1dGhPcHRpb25zKTtcbmV4cG9ydCB7IGhhbmRsZXIgYXMgR0VULCBoYW5kbGVyIGFzIFBPU1QgfTtcbiJdLCJuYW1lcyI6WyJOZXh0QXV0aCIsIkNyZWRlbnRpYWxzUHJvdmlkZXIiLCJjb21wYXJlIiwiY29ubmVjdERCIiwiVXNlciIsIkxvZyIsImF1dGhPcHRpb25zIiwicHJvdmlkZXJzIiwiaWQiLCJuYW1lIiwiY3JlZGVudGlhbHMiLCJ1c2VybmFtZSIsImxhYmVsIiwidHlwZSIsInBhc3N3b3JkIiwiYXV0aG9yaXplIiwiY3JlYXRlIiwibWVzc2FnZSIsIm1ldGFkYXRhIiwiRXJyb3IiLCJ1c2VyIiwiZmluZE9uZSIsIiRvciIsImVtYWlsIiwidG9Mb3dlckNhc2UiLCJzZWxlY3QiLCJpc0xvY2tlZE91dCIsInVzZXJJZCIsIl9pZCIsImlzVmFsaWRQYXNzd29yZCIsImZhaWxlZExvZ2luQXR0ZW1wdHMiLCJsb2Nrb3V0VGltZSIsIkRhdGUiLCJub3ciLCJzYXZlIiwibGFzdExvZ2luIiwidG9TdHJpbmciLCJyb2xlIiwiaW1hZ2UiLCJlcnJvciIsImNvbnNvbGUiLCJjYWxsYmFja3MiLCJqd3QiLCJ0b2tlbiIsImFjY291bnQiLCJ0cmlnZ2VyIiwic2Vzc2lvbiIsInBhZ2VzIiwic2lnbkluIiwic3RyYXRlZ3kiLCJtYXhBZ2UiLCJzZWNyZXQiLCJwcm9jZXNzIiwiZW52IiwiTkVYVEFVVEhfU0VDUkVUIiwiZGVidWciLCJoYW5kbGVyIiwiR0VUIiwiUE9TVCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/auth/[...nextauth]/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/mongodb.ts":
/*!****************************!*\
  !*** ./src/lib/mongodb.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   connectDB: () => (/* binding */ connectDB),\n/* harmony export */   disconnect: () => (/* binding */ disconnect),\n/* harmony export */   getConnection: () => (/* binding */ getConnection)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _models_init__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/models/init */ \"(rsc)/./src/models/init.ts\");\n\n\n// Only run on server side\nconst isServer = \"undefined\" === 'undefined';\nif (!isServer) {\n    throw new Error('MongoDB connection can only be established on the server side');\n}\n// Ensure we have a valid MONGODB_URI\nconst MONGODB_URI = \"mongodb://localhost:27017/devoapp\" || 0;\nif (!MONGODB_URI) {\n    throw new Error('Please define MONGODB_URI in your environment variables');\n}\nlet cached = global.mongoose || {\n    conn: null,\n    promise: null\n};\nasync function connectDB() {\n    if (!isServer) {\n        throw new Error('Cannot connect to MongoDB from the client side');\n    }\n    if (cached.conn) {\n        return cached.conn;\n    }\n    if (!cached.promise) {\n        const opts = {\n            bufferCommands: false,\n            useNewUrlParser: true,\n            useUnifiedTopology: true\n        };\n        cached.promise = mongoose__WEBPACK_IMPORTED_MODULE_0___default().connect(MONGODB_URI, opts).then((mongoose)=>{\n            (0,_models_init__WEBPACK_IMPORTED_MODULE_1__.initializeModels)();\n            return mongoose;\n        });\n    }\n    try {\n        cached.conn = (await cached.promise).connection;\n        return cached.conn;\n    } catch (error) {\n        cached.promise = null;\n        throw error;\n    }\n}\nasync function disconnect() {\n    if (!isServer) return;\n    if (cached.conn) {\n        await mongoose__WEBPACK_IMPORTED_MODULE_0___default().disconnect();\n        cached.conn = null;\n        cached.promise = null;\n    }\n}\n// Debug mode only on server side\nif ( true && isServer) {\n    mongoose__WEBPACK_IMPORTED_MODULE_0___default().set('debug', true);\n}\nfunction getConnection() {\n    if (!isServer) {\n        throw new Error('Cannot get MongoDB connection from client side');\n    }\n    return cached.conn;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL21vbmdvZGIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQWdDO0FBQ2lCO0FBRWpELDBCQUEwQjtBQUMxQixNQUFNRSxXQUFXLGdCQUFrQjtBQUVuQyxJQUFJLENBQUNBLFVBQVU7SUFDYixNQUFNLElBQUlDLE1BQU07QUFDbEI7QUFFQSxxQ0FBcUM7QUFDckMsTUFBTUMsY0FBY0MsbUNBQXVCLElBQUksQ0FBbUM7QUFFbEYsSUFBSSxDQUFDRCxhQUFhO0lBQ2hCLE1BQU0sSUFBSUQsTUFBTTtBQUNsQjtBQVNBLElBQUlJLFNBQVNDLE9BQU9SLFFBQVEsSUFBSTtJQUFFUyxNQUFNO0lBQU1DLFNBQVM7QUFBSztBQUVyRCxlQUFlQztJQUNwQixJQUFJLENBQUNULFVBQVU7UUFDYixNQUFNLElBQUlDLE1BQU07SUFDbEI7SUFFQSxJQUFJSSxPQUFPRSxJQUFJLEVBQUU7UUFDZixPQUFPRixPQUFPRSxJQUFJO0lBQ3BCO0lBRUEsSUFBSSxDQUFDRixPQUFPRyxPQUFPLEVBQUU7UUFDbkIsTUFBTUUsT0FBTztZQUNYQyxnQkFBZ0I7WUFDaEJDLGlCQUFpQjtZQUNqQkMsb0JBQW9CO1FBQ3RCO1FBRUFSLE9BQU9HLE9BQU8sR0FBR1YsdURBQWdCLENBQUNJLGFBQWFRLE1BQU1LLElBQUksQ0FBQyxDQUFDakI7WUFDekRDLDhEQUFnQkE7WUFDaEIsT0FBT0Q7UUFDVDtJQUNGO0lBRUEsSUFBSTtRQUNGTyxPQUFPRSxJQUFJLEdBQUcsQ0FBQyxNQUFNRixPQUFPRyxPQUFPLEVBQUVRLFVBQVU7UUFDL0MsT0FBT1gsT0FBT0UsSUFBSTtJQUNwQixFQUFFLE9BQU9VLE9BQU87UUFDZFosT0FBT0csT0FBTyxHQUFHO1FBQ2pCLE1BQU1TO0lBQ1I7QUFDRjtBQUVPLGVBQWVDO0lBQ3BCLElBQUksQ0FBQ2xCLFVBQVU7SUFFZixJQUFJSyxPQUFPRSxJQUFJLEVBQUU7UUFDZixNQUFNVCwwREFBbUI7UUFDekJPLE9BQU9FLElBQUksR0FBRztRQUNkRixPQUFPRyxPQUFPLEdBQUc7SUFDbkI7QUFDRjtBQUVBLGlDQUFpQztBQUNqQyxJQUFJTCxLQUFzQyxJQUFJSCxVQUFVO0lBQ3RERixtREFBWSxDQUFDLFNBQVM7QUFDeEI7QUFFTyxTQUFTc0I7SUFDZCxJQUFJLENBQUNwQixVQUFVO1FBQ2IsTUFBTSxJQUFJQyxNQUFNO0lBQ2xCO0lBQ0EsT0FBT0ksT0FBT0UsSUFBSTtBQUNwQiIsInNvdXJjZXMiOlsiL1VzZXJzL2ZyZWRlcmlja2RpbmVlbi9EZXNrdG9wL2Rldm9hcHAvc3JjL2xpYi9tb25nb2RiLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tICdtb25nb29zZSc7XG5pbXBvcnQgeyBpbml0aWFsaXplTW9kZWxzIH0gZnJvbSAnQC9tb2RlbHMvaW5pdCc7XG5cbi8vIE9ubHkgcnVuIG9uIHNlcnZlciBzaWRlXG5jb25zdCBpc1NlcnZlciA9IHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnO1xuXG5pZiAoIWlzU2VydmVyKSB7XG4gIHRocm93IG5ldyBFcnJvcignTW9uZ29EQiBjb25uZWN0aW9uIGNhbiBvbmx5IGJlIGVzdGFibGlzaGVkIG9uIHRoZSBzZXJ2ZXIgc2lkZScpO1xufVxuXG4vLyBFbnN1cmUgd2UgaGF2ZSBhIHZhbGlkIE1PTkdPREJfVVJJXG5jb25zdCBNT05HT0RCX1VSSSA9IHByb2Nlc3MuZW52Lk1PTkdPREJfVVJJIHx8ICdtb25nb2RiOi8vbG9jYWxob3N0OjI3MDE3L2Rldm9hcHAnO1xuXG5pZiAoIU1PTkdPREJfVVJJKSB7XG4gIHRocm93IG5ldyBFcnJvcignUGxlYXNlIGRlZmluZSBNT05HT0RCX1VSSSBpbiB5b3VyIGVudmlyb25tZW50IHZhcmlhYmxlcycpO1xufVxuXG5kZWNsYXJlIGdsb2JhbCB7XG4gIHZhciBtb25nb29zZToge1xuICAgIGNvbm46IG1vbmdvb3NlLkNvbm5lY3Rpb24gfCBudWxsO1xuICAgIHByb21pc2U6IFByb21pc2U8dHlwZW9mIG1vbmdvb3NlPiB8IG51bGw7XG4gIH07XG59XG5cbmxldCBjYWNoZWQgPSBnbG9iYWwubW9uZ29vc2UgfHwgeyBjb25uOiBudWxsLCBwcm9taXNlOiBudWxsIH07XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb25uZWN0REIoKSB7XG4gIGlmICghaXNTZXJ2ZXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBjb25uZWN0IHRvIE1vbmdvREIgZnJvbSB0aGUgY2xpZW50IHNpZGUnKTtcbiAgfVxuXG4gIGlmIChjYWNoZWQuY29ubikge1xuICAgIHJldHVybiBjYWNoZWQuY29ubjtcbiAgfVxuXG4gIGlmICghY2FjaGVkLnByb21pc2UpIHtcbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgYnVmZmVyQ29tbWFuZHM6IGZhbHNlLFxuICAgICAgdXNlTmV3VXJsUGFyc2VyOiB0cnVlLFxuICAgICAgdXNlVW5pZmllZFRvcG9sb2d5OiB0cnVlLFxuICAgIH07XG5cbiAgICBjYWNoZWQucHJvbWlzZSA9IG1vbmdvb3NlLmNvbm5lY3QoTU9OR09EQl9VUkksIG9wdHMpLnRoZW4oKG1vbmdvb3NlKSA9PiB7XG4gICAgICBpbml0aWFsaXplTW9kZWxzKCk7XG4gICAgICByZXR1cm4gbW9uZ29vc2U7XG4gICAgfSk7XG4gIH1cblxuICB0cnkge1xuICAgIGNhY2hlZC5jb25uID0gKGF3YWl0IGNhY2hlZC5wcm9taXNlKS5jb25uZWN0aW9uO1xuICAgIHJldHVybiBjYWNoZWQuY29ubjtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjYWNoZWQucHJvbWlzZSA9IG51bGw7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRpc2Nvbm5lY3QoKSB7XG4gIGlmICghaXNTZXJ2ZXIpIHJldHVybjtcbiAgXG4gIGlmIChjYWNoZWQuY29ubikge1xuICAgIGF3YWl0IG1vbmdvb3NlLmRpc2Nvbm5lY3QoKTtcbiAgICBjYWNoZWQuY29ubiA9IG51bGw7XG4gICAgY2FjaGVkLnByb21pc2UgPSBudWxsO1xuICB9XG59XG5cbi8vIERlYnVnIG1vZGUgb25seSBvbiBzZXJ2ZXIgc2lkZVxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnICYmIGlzU2VydmVyKSB7XG4gIG1vbmdvb3NlLnNldCgnZGVidWcnLCB0cnVlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENvbm5lY3Rpb24oKSB7XG4gIGlmICghaXNTZXJ2ZXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBnZXQgTW9uZ29EQiBjb25uZWN0aW9uIGZyb20gY2xpZW50IHNpZGUnKTtcbiAgfVxuICByZXR1cm4gY2FjaGVkLmNvbm47XG59XG4iXSwibmFtZXMiOlsibW9uZ29vc2UiLCJpbml0aWFsaXplTW9kZWxzIiwiaXNTZXJ2ZXIiLCJFcnJvciIsIk1PTkdPREJfVVJJIiwicHJvY2VzcyIsImVudiIsImNhY2hlZCIsImdsb2JhbCIsImNvbm4iLCJwcm9taXNlIiwiY29ubmVjdERCIiwib3B0cyIsImJ1ZmZlckNvbW1hbmRzIiwidXNlTmV3VXJsUGFyc2VyIiwidXNlVW5pZmllZFRvcG9sb2d5IiwiY29ubmVjdCIsInRoZW4iLCJjb25uZWN0aW9uIiwiZXJyb3IiLCJkaXNjb25uZWN0Iiwic2V0IiwiZ2V0Q29ubmVjdGlvbiJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/mongodb.ts\n");

/***/ }),

/***/ "(rsc)/./src/models/Log.ts":
/*!***************************!*\
  !*** ./src/models/Log.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst LogSchema = new (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema)({\n    type: {\n        type: String,\n        required: true,\n        enum: [\n            'LOGIN',\n            'LOGOUT',\n            'USER_CREATED',\n            'USER_UPDATED',\n            'USER_DELETED',\n            'IMPERSONATION',\n            'ADMIN_ACTION',\n            'SECURITY_EVENT'\n        ]\n    },\n    message: {\n        type: String,\n        required: true\n    },\n    userId: {\n        type: String,\n        ref: 'User'\n    },\n    adminId: {\n        type: String,\n        ref: 'User'\n    },\n    targetUserId: {\n        type: String,\n        ref: 'User'\n    },\n    metadata: {\n        type: (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema).Types.Mixed\n    },\n    timestamp: {\n        type: Date,\n        default: Date.now,\n        index: true\n    }\n}, {\n    timestamps: true,\n    collection: 'logs'\n});\n// Create indexes for efficient querying\nLogSchema.index({\n    type: 1,\n    timestamp: -1\n});\nLogSchema.index({\n    userId: 1,\n    timestamp: -1\n});\nLogSchema.index({\n    adminId: 1,\n    timestamp: -1\n});\nconst Log = (mongoose__WEBPACK_IMPORTED_MODULE_0___default().models).Log || mongoose__WEBPACK_IMPORTED_MODULE_0___default().model('Log', LogSchema);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Log);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbW9kZWxzL0xvZy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBZ0M7QUFZaEMsTUFBTUMsWUFBWSxJQUFJRCx3REFBZSxDQUFPO0lBQzFDRyxNQUFNO1FBQ0pBLE1BQU1DO1FBQ05DLFVBQVU7UUFDVkMsTUFBTTtZQUNKO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7U0FDRDtJQUNIO0lBQ0FDLFNBQVM7UUFDUEosTUFBTUM7UUFDTkMsVUFBVTtJQUNaO0lBQ0FHLFFBQVE7UUFDTkwsTUFBTUM7UUFDTkssS0FBSztJQUNQO0lBQ0FDLFNBQVM7UUFDUFAsTUFBTUM7UUFDTkssS0FBSztJQUNQO0lBQ0FFLGNBQWM7UUFDWlIsTUFBTUM7UUFDTkssS0FBSztJQUNQO0lBQ0FHLFVBQVU7UUFDUlQsTUFBTUgsd0RBQWUsQ0FBQ2EsS0FBSyxDQUFDQyxLQUFLO0lBQ25DO0lBQ0FDLFdBQVc7UUFDVFosTUFBTWE7UUFDTkMsU0FBU0QsS0FBS0UsR0FBRztRQUNqQkMsT0FBTztJQUNUO0FBQ0YsR0FBRztJQUNEQyxZQUFZO0lBQ1pDLFlBQVk7QUFDZDtBQUVBLHdDQUF3QztBQUN4Q3BCLFVBQVVrQixLQUFLLENBQUM7SUFBRWhCLE1BQU07SUFBR1ksV0FBVyxDQUFDO0FBQUU7QUFDekNkLFVBQVVrQixLQUFLLENBQUM7SUFBRVgsUUFBUTtJQUFHTyxXQUFXLENBQUM7QUFBRTtBQUMzQ2QsVUFBVWtCLEtBQUssQ0FBQztJQUFFVCxTQUFTO0lBQUdLLFdBQVcsQ0FBQztBQUFFO0FBRTVDLE1BQU1PLE1BQU10Qix3REFBZSxDQUFDc0IsR0FBRyxJQUFJdEIscURBQWMsQ0FBTyxPQUFPQztBQUUvRCxpRUFBZXFCLEdBQUdBLEVBQUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmVkZXJpY2tkaW5lZW4vRGVza3RvcC9kZXZvYXBwL3NyYy9tb2RlbHMvTG9nLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tICdtb25nb29zZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUxvZyBleHRlbmRzIG1vbmdvb3NlLkRvY3VtZW50IHtcbiAgdHlwZTogc3RyaW5nO1xuICBtZXNzYWdlOiBzdHJpbmc7XG4gIHVzZXJJZD86IHN0cmluZztcbiAgYWRtaW5JZD86IHN0cmluZztcbiAgdGFyZ2V0VXNlcklkPzogc3RyaW5nO1xuICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT47XG4gIHRpbWVzdGFtcDogRGF0ZTtcbn1cblxuY29uc3QgTG9nU2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYTxJTG9nPih7XG4gIHR5cGU6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgZW51bTogW1xuICAgICAgJ0xPR0lOJywgXG4gICAgICAnTE9HT1VUJywgXG4gICAgICAnVVNFUl9DUkVBVEVEJywgXG4gICAgICAnVVNFUl9VUERBVEVEJywgXG4gICAgICAnVVNFUl9ERUxFVEVEJywgXG4gICAgICAnSU1QRVJTT05BVElPTicsIFxuICAgICAgJ0FETUlOX0FDVElPTicsIFxuICAgICAgJ1NFQ1VSSVRZX0VWRU5UJ1xuICAgIF1cbiAgfSxcbiAgbWVzc2FnZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZVxuICB9LFxuICB1c2VySWQ6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVmOiAnVXNlcidcbiAgfSxcbiAgYWRtaW5JZDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZWY6ICdVc2VyJ1xuICB9LFxuICB0YXJnZXRVc2VySWQ6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVmOiAnVXNlcidcbiAgfSxcbiAgbWV0YWRhdGE6IHtcbiAgICB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuTWl4ZWRcbiAgfSxcbiAgdGltZXN0YW1wOiB7XG4gICAgdHlwZTogRGF0ZSxcbiAgICBkZWZhdWx0OiBEYXRlLm5vdyxcbiAgICBpbmRleDogdHJ1ZVxuICB9XG59LCB7XG4gIHRpbWVzdGFtcHM6IHRydWUsXG4gIGNvbGxlY3Rpb246ICdsb2dzJ1xufSk7XG5cbi8vIENyZWF0ZSBpbmRleGVzIGZvciBlZmZpY2llbnQgcXVlcnlpbmdcbkxvZ1NjaGVtYS5pbmRleCh7IHR5cGU6IDEsIHRpbWVzdGFtcDogLTEgfSk7XG5Mb2dTY2hlbWEuaW5kZXgoeyB1c2VySWQ6IDEsIHRpbWVzdGFtcDogLTEgfSk7XG5Mb2dTY2hlbWEuaW5kZXgoeyBhZG1pbklkOiAxLCB0aW1lc3RhbXA6IC0xIH0pO1xuXG5jb25zdCBMb2cgPSBtb25nb29zZS5tb2RlbHMuTG9nIHx8IG1vbmdvb3NlLm1vZGVsPElMb2c+KCdMb2cnLCBMb2dTY2hlbWEpO1xuXG5leHBvcnQgZGVmYXVsdCBMb2c7XG4iXSwibmFtZXMiOlsibW9uZ29vc2UiLCJMb2dTY2hlbWEiLCJTY2hlbWEiLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJlbnVtIiwibWVzc2FnZSIsInVzZXJJZCIsInJlZiIsImFkbWluSWQiLCJ0YXJnZXRVc2VySWQiLCJtZXRhZGF0YSIsIlR5cGVzIiwiTWl4ZWQiLCJ0aW1lc3RhbXAiLCJEYXRlIiwiZGVmYXVsdCIsIm5vdyIsImluZGV4IiwidGltZXN0YW1wcyIsImNvbGxlY3Rpb24iLCJMb2ciLCJtb2RlbHMiLCJtb2RlbCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/models/Log.ts\n");

/***/ }),

/***/ "(rsc)/./src/models/User.ts":
/*!****************************!*\
  !*** ./src/models/User.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _schemas_UserSchema__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./schemas/UserSchema */ \"(rsc)/./src/models/schemas/UserSchema.ts\");\n\n\n\n// Only initialize on server side\nconst isServer = \"undefined\" === 'undefined';\nif (!isServer) {\n    throw new Error('Cannot access Mongoose models on the client side');\n}\n// Indexes\n_schemas_UserSchema__WEBPACK_IMPORTED_MODULE_2__.UserSchema.index({\n    email: 1\n}, {\n    unique: true\n});\n_schemas_UserSchema__WEBPACK_IMPORTED_MODULE_2__.UserSchema.index({\n    username: 1\n}, {\n    unique: true\n});\n_schemas_UserSchema__WEBPACK_IMPORTED_MODULE_2__.UserSchema.index({\n    role: 1\n});\n// Hash password before saving\n_schemas_UserSchema__WEBPACK_IMPORTED_MODULE_2__.UserSchema.pre('save', async function(next) {\n    if (!this.isModified('password')) return next();\n    try {\n        const salt = await bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().genSalt(10);\n        this.password = await bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().hash(this.password, salt);\n        next();\n    } catch (error) {\n        next(error);\n    }\n});\n// Method to compare passwords\n_schemas_UserSchema__WEBPACK_IMPORTED_MODULE_2__.UserSchema.methods.comparePassword = async function(candidatePassword) {\n    try {\n        return await bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().compare(candidatePassword, this.password);\n    } catch (error) {\n        return false;\n    }\n};\n// Method to increment login attempts\n_schemas_UserSchema__WEBPACK_IMPORTED_MODULE_2__.UserSchema.methods.incrementLoginAttempts = async function() {\n    const MAX_LOGIN_ATTEMPTS = 5;\n    const LOCK_TIME = 15 * 60 * 1000; // 15 minutes\n    if (this.lockUntil && this.lockUntil > new Date()) {\n        return {\n            isLocked: true,\n            remainingTime: Math.ceil((this.lockUntil.getTime() - Date.now()) / 1000 / 60)\n        };\n    }\n    this.failedLoginAttempts += 1;\n    if (this.failedLoginAttempts >= MAX_LOGIN_ATTEMPTS) {\n        this.lockUntil = new Date(Date.now() + LOCK_TIME);\n    }\n    await this.save();\n    return {\n        isLocked: this.failedLoginAttempts >= MAX_LOGIN_ATTEMPTS,\n        remainingTime: this.lockUntil ? Math.ceil((this.lockUntil.getTime() - Date.now()) / 1000 / 60) : 0\n    };\n};\n// Method to reset login attempts\n_schemas_UserSchema__WEBPACK_IMPORTED_MODULE_2__.UserSchema.methods.resetLoginAttempts = async function() {\n    this.failedLoginAttempts = 0;\n    this.lockUntil = undefined;\n    await this.save();\n};\n// Add static methods\n_schemas_UserSchema__WEBPACK_IMPORTED_MODULE_2__.UserSchema.statics.findByEmail = function(email) {\n    return this.findOne({\n        email: email.toLowerCase()\n    });\n};\n_schemas_UserSchema__WEBPACK_IMPORTED_MODULE_2__.UserSchema.statics.findByUsername = function(username) {\n    return this.findOne({\n        username: username.toLowerCase()\n    });\n};\n// Export the model\nconst User = (mongoose__WEBPACK_IMPORTED_MODULE_0___default().models).User || mongoose__WEBPACK_IMPORTED_MODULE_0___default().model('User', _schemas_UserSchema__WEBPACK_IMPORTED_MODULE_2__.UserSchema);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (User);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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T0FBTyxDQUFDO1FBQUUvQixVQUFVQSxTQUFTZ0MsV0FBVztJQUFHO0FBQ3pEO0FBRUEsbUJBQW1CO0FBQ25CLE1BQU1FLE9BQVExQyx3REFBZSxDQUFDMEMsSUFBSSxJQUFJMUMscURBQWMsQ0FBb0IsUUFBUUUsMkRBQVVBO0FBRTFGLGlFQUFld0MsSUFBSUEsRUFBQyIsInNvdXJjZXMiOlsiL1VzZXJzL2ZyZWRlcmlja2RpbmVlbi9EZXNrdG9wL2Rldm9hcHAvc3JjL21vZGVscy9Vc2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tICdtb25nb29zZSc7XG5pbXBvcnQgYmNyeXB0IGZyb20gJ2JjcnlwdGpzJztcbmltcG9ydCB2YWxpZGF0b3IgZnJvbSAndmFsaWRhdG9yJztcbmltcG9ydCB7IFVzZXJTY2hlbWEgfSBmcm9tICcuL3NjaGVtYXMvVXNlclNjaGVtYSc7XG5cbi8vIE9ubHkgaW5pdGlhbGl6ZSBvbiBzZXJ2ZXIgc2lkZVxuY29uc3QgaXNTZXJ2ZXIgPSB0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJztcblxuaWYgKCFpc1NlcnZlcikge1xuICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBhY2Nlc3MgTW9uZ29vc2UgbW9kZWxzIG9uIHRoZSBjbGllbnQgc2lkZScpO1xufVxuXG4vLyBEZWZpbmUgaW50ZXJmYWNlc1xuaW50ZXJmYWNlIElVc2VyIHtcbiAgdXNlcm5hbWU6IHN0cmluZztcbiAgZW1haWw6IHN0cmluZztcbiAgcGFzc3dvcmQ6IHN0cmluZztcbiAgbmFtZT86IHN0cmluZztcbiAgcm9sZTogJ1VTRVInIHwgJ0FETUlOJyB8ICdTVVBFUl9BRE1JTic7XG4gIGlzQWN0aXZlOiBib29sZWFuO1xuICBmYWlsZWRMb2dpbkF0dGVtcHRzOiBudW1iZXI7XG4gIGxvY2tVbnRpbD86IERhdGU7XG4gIGxhc3RMb2dpbj86IERhdGU7XG4gIHBhc3N3b3JkQ2hhbmdlZEF0PzogRGF0ZTtcbiAgcmVzZXRQYXNzd29yZFRva2VuPzogc3RyaW5nO1xuICByZXNldFBhc3N3b3JkRXhwaXJlcz86IERhdGU7XG4gIGNvbXBhcmVQYXNzd29yZChjYW5kaWRhdGVQYXNzd29yZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPjtcbiAgaW5jcmVtZW50TG9naW5BdHRlbXB0cygpOiBQcm9taXNlPHsgaXNMb2NrZWQ6IGJvb2xlYW47IHJlbWFpbmluZ1RpbWU6IG51bWJlciB9PjtcbiAgcmVzZXRMb2dpbkF0dGVtcHRzKCk6IFByb21pc2U8dm9pZD47XG59XG5cbmludGVyZmFjZSBJVXNlck1vZGVsIGV4dGVuZHMgbW9uZ29vc2UuTW9kZWw8SVVzZXI+IHtcbiAgZmluZEJ5RW1haWwoZW1haWw6IHN0cmluZyk6IFByb21pc2U8SVVzZXIgfCBudWxsPjtcbiAgZmluZEJ5VXNlcm5hbWUodXNlcm5hbWU6IHN0cmluZyk6IFByb21pc2U8SVVzZXIgfCBudWxsPjtcbn1cblxuLy8gSW5kZXhlc1xuVXNlclNjaGVtYS5pbmRleCh7IGVtYWlsOiAxIH0sIHsgdW5pcXVlOiB0cnVlIH0pO1xuVXNlclNjaGVtYS5pbmRleCh7IHVzZXJuYW1lOiAxIH0sIHsgdW5pcXVlOiB0cnVlIH0pO1xuVXNlclNjaGVtYS5pbmRleCh7IHJvbGU6IDEgfSk7XG5cbi8vIEhhc2ggcGFzc3dvcmQgYmVmb3JlIHNhdmluZ1xuVXNlclNjaGVtYS5wcmUoJ3NhdmUnLCBhc3luYyBmdW5jdGlvbihuZXh0KSB7XG4gIGlmICghdGhpcy5pc01vZGlmaWVkKCdwYXNzd29yZCcpKSByZXR1cm4gbmV4dCgpO1xuICBcbiAgdHJ5IHtcbiAgICBjb25zdCBzYWx0ID0gYXdhaXQgYmNyeXB0LmdlblNhbHQoMTApO1xuICAgIHRoaXMucGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuaGFzaCh0aGlzLnBhc3N3b3JkLCBzYWx0KTtcbiAgICBuZXh0KCk7XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICBuZXh0KGVycm9yKTtcbiAgfVxufSk7XG5cbi8vIE1ldGhvZCB0byBjb21wYXJlIHBhc3N3b3Jkc1xuVXNlclNjaGVtYS5tZXRob2RzLmNvbXBhcmVQYXNzd29yZCA9IGFzeW5jIGZ1bmN0aW9uKGNhbmRpZGF0ZVBhc3N3b3JkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgYmNyeXB0LmNvbXBhcmUoY2FuZGlkYXRlUGFzc3dvcmQsIHRoaXMucGFzc3dvcmQpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufTtcblxuLy8gTWV0aG9kIHRvIGluY3JlbWVudCBsb2dpbiBhdHRlbXB0c1xuVXNlclNjaGVtYS5tZXRob2RzLmluY3JlbWVudExvZ2luQXR0ZW1wdHMgPSBhc3luYyBmdW5jdGlvbigpIHtcbiAgY29uc3QgTUFYX0xPR0lOX0FUVEVNUFRTID0gNTtcbiAgY29uc3QgTE9DS19USU1FID0gMTUgKiA2MCAqIDEwMDA7IC8vIDE1IG1pbnV0ZXNcblxuICBpZiAodGhpcy5sb2NrVW50aWwgJiYgdGhpcy5sb2NrVW50aWwgPiBuZXcgRGF0ZSgpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlzTG9ja2VkOiB0cnVlLFxuICAgICAgcmVtYWluaW5nVGltZTogTWF0aC5jZWlsKCh0aGlzLmxvY2tVbnRpbC5nZXRUaW1lKCkgLSBEYXRlLm5vdygpKSAvIDEwMDAgLyA2MCksXG4gICAgfTtcbiAgfVxuXG4gIHRoaXMuZmFpbGVkTG9naW5BdHRlbXB0cyArPSAxO1xuXG4gIGlmICh0aGlzLmZhaWxlZExvZ2luQXR0ZW1wdHMgPj0gTUFYX0xPR0lOX0FUVEVNUFRTKSB7XG4gICAgdGhpcy5sb2NrVW50aWwgPSBuZXcgRGF0ZShEYXRlLm5vdygpICsgTE9DS19USU1FKTtcbiAgfVxuXG4gIGF3YWl0IHRoaXMuc2F2ZSgpO1xuXG4gIHJldHVybiB7XG4gICAgaXNMb2NrZWQ6IHRoaXMuZmFpbGVkTG9naW5BdHRlbXB0cyA+PSBNQVhfTE9HSU5fQVRURU1QVFMsXG4gICAgcmVtYWluaW5nVGltZTogdGhpcy5sb2NrVW50aWwgPyBNYXRoLmNlaWwoKHRoaXMubG9ja1VudGlsLmdldFRpbWUoKSAtIERhdGUubm93KCkpIC8gMTAwMCAvIDYwKSA6IDAsXG4gIH07XG59O1xuXG4vLyBNZXRob2QgdG8gcmVzZXQgbG9naW4gYXR0ZW1wdHNcblVzZXJTY2hlbWEubWV0aG9kcy5yZXNldExvZ2luQXR0ZW1wdHMgPSBhc3luYyBmdW5jdGlvbigpIHtcbiAgdGhpcy5mYWlsZWRMb2dpbkF0dGVtcHRzID0gMDtcbiAgdGhpcy5sb2NrVW50aWwgPSB1bmRlZmluZWQ7XG4gIGF3YWl0IHRoaXMuc2F2ZSgpO1xufTtcblxuLy8gQWRkIHN0YXRpYyBtZXRob2RzXG5Vc2VyU2NoZW1hLnN0YXRpY3MuZmluZEJ5RW1haWwgPSBmdW5jdGlvbihlbWFpbDogc3RyaW5nKSB7XG4gIHJldHVybiB0aGlzLmZpbmRPbmUoeyBlbWFpbDogZW1haWwudG9Mb3dlckNhc2UoKSB9KTtcbn07XG5cblVzZXJTY2hlbWEuc3RhdGljcy5maW5kQnlVc2VybmFtZSA9IGZ1bmN0aW9uKHVzZXJuYW1lOiBzdHJpbmcpIHtcbiAgcmV0dXJuIHRoaXMuZmluZE9uZSh7IHVzZXJuYW1lOiB1c2VybmFtZS50b0xvd2VyQ2FzZSgpIH0pO1xufTtcblxuLy8gRXhwb3J0IHRoZSBtb2RlbFxuY29uc3QgVXNlciA9IChtb25nb29zZS5tb2RlbHMuVXNlciB8fCBtb25nb29zZS5tb2RlbDxJVXNlciwgSVVzZXJNb2RlbD4oJ1VzZXInLCBVc2VyU2NoZW1hKSkgYXMgSVVzZXJNb2RlbDtcblxuZXhwb3J0IGRlZmF1bHQgVXNlcjtcbiJdLCJuYW1lcyI6WyJtb25nb29zZSIsImJjcnlwdCIsIlVzZXJTY2hlbWEiLCJpc1NlcnZlciIsIkVycm9yIiwiaW5kZXgiLCJlbWFpbCIsInVuaXF1ZSIsInVzZXJuYW1lIiwicm9sZSIsInByZSIsIm5leHQiLCJpc01vZGlmaWVkIiwic2FsdCIsImdlblNhbHQiLCJwYXNzd29yZCIsImhhc2giLCJlcnJvciIsIm1ldGhvZHMiLCJjb21wYXJlUGFzc3dvcmQiLCJjYW5kaWRhdGVQYXNzd29yZCIsImNvbXBhcmUiLCJpbmNyZW1lbnRMb2dpbkF0dGVtcHRzIiwiTUFYX0xPR0lOX0FUVEVNUFRTIiwiTE9DS19USU1FIiwibG9ja1VudGlsIiwiRGF0ZSIsImlzTG9ja2VkIiwicmVtYWluaW5nVGltZSIsIk1hdGgiLCJjZWlsIiwiZ2V0VGltZSIsIm5vdyIsImZhaWxlZExvZ2luQXR0ZW1wdHMiLCJzYXZlIiwicmVzZXRMb2dpbkF0dGVtcHRzIiwidW5kZWZpbmVkIiwic3RhdGljcyIsImZpbmRCeUVtYWlsIiwiZmluZE9uZSIsInRvTG93ZXJDYXNlIiwiZmluZEJ5VXNlcm5hbWUiLCJVc2VyIiwibW9kZWxzIiwibW9kZWwiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/models/User.ts\n");

/***/ }),

/***/ "(rsc)/./src/models/init.ts":
/*!****************************!*\
  !*** ./src/models/init.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   User: () => (/* binding */ User),\n/* harmony export */   getModel: () => (/* binding */ getModel),\n/* harmony export */   initializeModels: () => (/* binding */ initializeModels)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _schemas_UserSchema__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./schemas/UserSchema */ \"(rsc)/./src/models/schemas/UserSchema.ts\");\n\n\n// Only initialize models on the server side\nconst isServer = \"undefined\" === 'undefined';\n// Singleton pattern for model initialization\nfunction getModel(modelName, schema) {\n    if (!isServer) {\n        throw new Error('Cannot access Mongoose models on the client side');\n    }\n    // Check if the model already exists\n    if ((mongoose__WEBPACK_IMPORTED_MODULE_0___default().models)[modelName]) {\n        return (mongoose__WEBPACK_IMPORTED_MODULE_0___default().models)[modelName];\n    }\n    // Create a new model\n    return mongoose__WEBPACK_IMPORTED_MODULE_0___default().model(modelName, schema);\n}\n// Initialize User model (only on server)\nconst User = isServer ? getModel('User', _schemas_UserSchema__WEBPACK_IMPORTED_MODULE_1__.UserSchema) : null;\n// Ensure models are initialized on server\nfunction initializeModels() {\n    if (!isServer) return;\n    // Initialize models\n    getModel('User', _schemas_UserSchema__WEBPACK_IMPORTED_MODULE_1__.UserSchema);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbW9kZWxzL2luaXQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQWdDO0FBQ2tCO0FBRWxELDRDQUE0QztBQUM1QyxNQUFNRSxXQUFXLGdCQUFrQjtBQUVuQyw2Q0FBNkM7QUFDdEMsU0FBU0MsU0FDZEMsU0FBaUIsRUFDakJDLE1BQXVCO0lBRXZCLElBQUksQ0FBQ0gsVUFBVTtRQUNiLE1BQU0sSUFBSUksTUFBTTtJQUNsQjtJQUVBLG9DQUFvQztJQUNwQyxJQUFJTix3REFBZSxDQUFDSSxVQUFVLEVBQUU7UUFDOUIsT0FBT0osd0RBQWUsQ0FBQ0ksVUFBVTtJQUNuQztJQUVBLHFCQUFxQjtJQUNyQixPQUFPSixxREFBYyxDQUFDSSxXQUFXQztBQUNuQztBQUVBLHlDQUF5QztBQUNsQyxNQUFNSSxPQUFPUCxXQUFXQyxTQUFTLFFBQVFGLDJEQUFVQSxJQUFJLEtBQUs7QUFFbkUsMENBQTBDO0FBQ25DLFNBQVNTO0lBQ2QsSUFBSSxDQUFDUixVQUFVO0lBRWYsb0JBQW9CO0lBQ3BCQyxTQUFTLFFBQVFGLDJEQUFVQTtBQUM3QiIsInNvdXJjZXMiOlsiL1VzZXJzL2ZyZWRlcmlja2RpbmVlbi9EZXNrdG9wL2Rldm9hcHAvc3JjL21vZGVscy9pbml0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tICdtb25nb29zZSc7XG5pbXBvcnQgeyBVc2VyU2NoZW1hIH0gZnJvbSAnLi9zY2hlbWFzL1VzZXJTY2hlbWEnO1xuXG4vLyBPbmx5IGluaXRpYWxpemUgbW9kZWxzIG9uIHRoZSBzZXJ2ZXIgc2lkZVxuY29uc3QgaXNTZXJ2ZXIgPSB0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJztcblxuLy8gU2luZ2xldG9uIHBhdHRlcm4gZm9yIG1vZGVsIGluaXRpYWxpemF0aW9uXG5leHBvcnQgZnVuY3Rpb24gZ2V0TW9kZWw8VCBleHRlbmRzIG1vbmdvb3NlLk1vZGVsPGFueT4+KFxuICBtb2RlbE5hbWU6IHN0cmluZywgXG4gIHNjaGVtYTogbW9uZ29vc2UuU2NoZW1hXG4pOiBUIHtcbiAgaWYgKCFpc1NlcnZlcikge1xuICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGFjY2VzcyBNb25nb29zZSBtb2RlbHMgb24gdGhlIGNsaWVudCBzaWRlJyk7XG4gIH1cblxuICAvLyBDaGVjayBpZiB0aGUgbW9kZWwgYWxyZWFkeSBleGlzdHNcbiAgaWYgKG1vbmdvb3NlLm1vZGVsc1ttb2RlbE5hbWVdKSB7XG4gICAgcmV0dXJuIG1vbmdvb3NlLm1vZGVsc1ttb2RlbE5hbWVdIGFzIFQ7XG4gIH1cblxuICAvLyBDcmVhdGUgYSBuZXcgbW9kZWxcbiAgcmV0dXJuIG1vbmdvb3NlLm1vZGVsKG1vZGVsTmFtZSwgc2NoZW1hKSBhcyBUO1xufVxuXG4vLyBJbml0aWFsaXplIFVzZXIgbW9kZWwgKG9ubHkgb24gc2VydmVyKVxuZXhwb3J0IGNvbnN0IFVzZXIgPSBpc1NlcnZlciA/IGdldE1vZGVsKCdVc2VyJywgVXNlclNjaGVtYSkgOiBudWxsO1xuXG4vLyBFbnN1cmUgbW9kZWxzIGFyZSBpbml0aWFsaXplZCBvbiBzZXJ2ZXJcbmV4cG9ydCBmdW5jdGlvbiBpbml0aWFsaXplTW9kZWxzKCkge1xuICBpZiAoIWlzU2VydmVyKSByZXR1cm47XG4gIFxuICAvLyBJbml0aWFsaXplIG1vZGVsc1xuICBnZXRNb2RlbCgnVXNlcicsIFVzZXJTY2hlbWEpO1xufVxuIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwiVXNlclNjaGVtYSIsImlzU2VydmVyIiwiZ2V0TW9kZWwiLCJtb2RlbE5hbWUiLCJzY2hlbWEiLCJFcnJvciIsIm1vZGVscyIsIm1vZGVsIiwiVXNlciIsImluaXRpYWxpemVNb2RlbHMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/models/init.ts\n");

/***/ }),

/***/ "(rsc)/./src/models/schemas/UserSchema.ts":
/*!******************************************!*\
  !*** ./src/models/schemas/UserSchema.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   UserSchema: () => (/* binding */ UserSchema)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var validator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! validator */ \"(rsc)/./node_modules/validator/index.js\");\n/* harmony import */ var validator__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(validator__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_1__);\n\n\n\nconst UserSchema = new mongoose__WEBPACK_IMPORTED_MODULE_0__.Schema({\n    username: {\n        type: String,\n        required: [\n            true,\n            'Username is required'\n        ],\n        unique: true,\n        trim: true,\n        minlength: [\n            3,\n            'Username must be at least 3 characters long'\n        ],\n        maxlength: [\n            30,\n            'Username cannot exceed 30 characters'\n        ],\n        validate: {\n            validator: (value)=>/^[a-zA-Z0-9_-]+$/.test(value),\n            message: 'Username can only contain letters, numbers, underscores, and hyphens'\n        }\n    },\n    email: {\n        type: String,\n        required: [\n            true,\n            'Email is required'\n        ],\n        unique: true,\n        trim: true,\n        lowercase: true,\n        validate: {\n            validator: (value)=>validator__WEBPACK_IMPORTED_MODULE_2___default().isEmail(value),\n            message: 'Please enter a valid email address'\n        }\n    },\n    password: {\n        type: String,\n        required: [\n            true,\n            'Password is required'\n        ],\n        minlength: [\n            8,\n            'Password must be at least 8 characters long'\n        ],\n        validate: {\n            validator: (value)=>{\n                return value.length >= 8 && /[A-Z]/.test(value) && // Has uppercase\n                /[a-z]/.test(value) && // Has lowercase\n                /[0-9]/.test(value) && // Has number\n                /[^A-Za-z0-9]/.test(value) // Has special character\n                ;\n            },\n            message: 'Password must contain at least one uppercase letter, one lowercase letter, one number, and one special character'\n        }\n    },\n    name: {\n        type: String,\n        required: [\n            true,\n            'Name is required'\n        ],\n        trim: true,\n        minlength: [\n            2,\n            'Name must be at least 2 characters long'\n        ],\n        maxlength: [\n            50,\n            'Name cannot exceed 50 characters'\n        ]\n    },\n    role: {\n        type: String,\n        enum: {\n            values: [\n                'USER',\n                'ADMIN',\n                'SUPER_ADMIN'\n            ],\n            message: '{VALUE} is not a valid role'\n        },\n        required: [\n            true,\n            'Role is required'\n        ]\n    },\n    isActive: {\n        type: Boolean,\n        default: true\n    },\n    failedLoginAttempts: {\n        type: Number,\n        default: 0\n    },\n    lastLogin: {\n        type: Date,\n        default: null\n    },\n    passwordChangedAt: {\n        type: Date,\n        default: Date.now\n    },\n    resetPasswordToken: String,\n    resetPasswordExpires: Date\n}, {\n    timestamps: true,\n    toJSON: {\n        transform: function(doc, ret) {\n            ret.id = ret._id.toString();\n            delete ret._id;\n            delete ret.__v;\n            delete ret.password;\n            delete ret.resetPasswordToken;\n            delete ret.resetPasswordExpires;\n            return ret;\n        }\n    }\n});\n// Add index for email and username\nUserSchema.index({\n    email: 1\n}, {\n    unique: true\n});\nUserSchema.index({\n    username: 1\n}, {\n    unique: true\n});\n// Pre-save middleware to hash password\nUserSchema.pre('save', async function(next) {\n    // Only hash the password if it has been modified (or is new)\n    if (!this.isModified('password')) return next();\n    try {\n        const salt = await bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().genSalt(10);\n        this.password = await bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().hash(this.password, salt);\n        next();\n    } catch (error) {\n        next(error);\n    }\n});\n// Method to compare passwords\nUserSchema.methods.comparePassword = async function(candidatePassword) {\n    try {\n        return await bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().compare(candidatePassword, this.password);\n    } catch (error) {\n        throw error;\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNL0MsdURBQWMsQ0FBQztRQUNsQyxJQUFJLENBQUNpQixRQUFRLEdBQUcsTUFBTWpCLG9EQUFXLENBQUMsSUFBSSxDQUFDaUIsUUFBUSxFQUFFOEI7UUFDakRGO0lBQ0YsRUFBRSxPQUFPSyxPQUFZO1FBQ25CTCxLQUFLSztJQUNQO0FBQ0Y7QUFFQSw4QkFBOEI7QUFDOUJqRCxXQUFXa0QsT0FBTyxDQUFDQyxlQUFlLEdBQUcsZUFBZUMsaUJBQXlCO0lBQzNFLElBQUk7UUFDRixPQUFPLE1BQU1yRCx1REFBYyxDQUFDcUQsbUJBQW1CLElBQUksQ0FBQ3BDLFFBQVE7SUFDOUQsRUFBRSxPQUFPaUMsT0FBTztRQUNkLE1BQU1BO0lBQ1I7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL2ZyZWRlcmlja2RpbmVlbi9EZXNrdG9wL2Rldm9hcHAvc3JjL21vZGVscy9zY2hlbWFzL1VzZXJTY2hlbWEudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU2NoZW1hIH0gZnJvbSAnbW9uZ29vc2UnO1xuaW1wb3J0IHZhbGlkYXRvciBmcm9tICd2YWxpZGF0b3InO1xuaW1wb3J0IGJjcnlwdCBmcm9tICdiY3J5cHRqcyc7XG5cbmV4cG9ydCBjb25zdCBVc2VyU2NoZW1hID0gbmV3IFNjaGVtYSh7XG4gIHVzZXJuYW1lOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiBbdHJ1ZSwgJ1VzZXJuYW1lIGlzIHJlcXVpcmVkJ10sXG4gICAgdW5pcXVlOiB0cnVlLFxuICAgIHRyaW06IHRydWUsXG4gICAgbWlubGVuZ3RoOiBbMywgJ1VzZXJuYW1lIG11c3QgYmUgYXQgbGVhc3QgMyBjaGFyYWN0ZXJzIGxvbmcnXSxcbiAgICBtYXhsZW5ndGg6IFszMCwgJ1VzZXJuYW1lIGNhbm5vdCBleGNlZWQgMzAgY2hhcmFjdGVycyddLFxuICAgIHZhbGlkYXRlOiB7XG4gICAgICB2YWxpZGF0b3I6ICh2YWx1ZTogc3RyaW5nKSA9PiAvXlthLXpBLVowLTlfLV0rJC8udGVzdCh2YWx1ZSksXG4gICAgICBtZXNzYWdlOiAnVXNlcm5hbWUgY2FuIG9ubHkgY29udGFpbiBsZXR0ZXJzLCBudW1iZXJzLCB1bmRlcnNjb3JlcywgYW5kIGh5cGhlbnMnLFxuICAgIH0sXG4gIH0sXG4gIGVtYWlsOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiBbdHJ1ZSwgJ0VtYWlsIGlzIHJlcXVpcmVkJ10sXG4gICAgdW5pcXVlOiB0cnVlLFxuICAgIHRyaW06IHRydWUsXG4gICAgbG93ZXJjYXNlOiB0cnVlLFxuICAgIHZhbGlkYXRlOiB7XG4gICAgICB2YWxpZGF0b3I6ICh2YWx1ZTogc3RyaW5nKSA9PiB2YWxpZGF0b3IuaXNFbWFpbCh2YWx1ZSksXG4gICAgICBtZXNzYWdlOiAnUGxlYXNlIGVudGVyIGEgdmFsaWQgZW1haWwgYWRkcmVzcycsXG4gICAgfSxcbiAgfSxcbiAgcGFzc3dvcmQ6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IFt0cnVlLCAnUGFzc3dvcmQgaXMgcmVxdWlyZWQnXSxcbiAgICBtaW5sZW5ndGg6IFs4LCAnUGFzc3dvcmQgbXVzdCBiZSBhdCBsZWFzdCA4IGNoYXJhY3RlcnMgbG9uZyddLFxuICAgIHZhbGlkYXRlOiB7XG4gICAgICB2YWxpZGF0b3I6ICh2YWx1ZTogc3RyaW5nKSA9PiB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgdmFsdWUubGVuZ3RoID49IDggJiZcbiAgICAgICAgICAvW0EtWl0vLnRlc3QodmFsdWUpICYmICAgIC8vIEhhcyB1cHBlcmNhc2VcbiAgICAgICAgICAvW2Etel0vLnRlc3QodmFsdWUpICYmICAgIC8vIEhhcyBsb3dlcmNhc2VcbiAgICAgICAgICAvWzAtOV0vLnRlc3QodmFsdWUpICYmICAgIC8vIEhhcyBudW1iZXJcbiAgICAgICAgICAvW15BLVphLXowLTldLy50ZXN0KHZhbHVlKSAvLyBIYXMgc3BlY2lhbCBjaGFyYWN0ZXJcbiAgICAgICAgKTtcbiAgICAgIH0sXG4gICAgICBtZXNzYWdlOiAnUGFzc3dvcmQgbXVzdCBjb250YWluIGF0IGxlYXN0IG9uZSB1cHBlcmNhc2UgbGV0dGVyLCBvbmUgbG93ZXJjYXNlIGxldHRlciwgb25lIG51bWJlciwgYW5kIG9uZSBzcGVjaWFsIGNoYXJhY3RlcicsXG4gICAgfSxcbiAgfSxcbiAgbmFtZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogW3RydWUsICdOYW1lIGlzIHJlcXVpcmVkJ10sXG4gICAgdHJpbTogdHJ1ZSxcbiAgICBtaW5sZW5ndGg6IFsyLCAnTmFtZSBtdXN0IGJlIGF0IGxlYXN0IDIgY2hhcmFjdGVycyBsb25nJ10sXG4gICAgbWF4bGVuZ3RoOiBbNTAsICdOYW1lIGNhbm5vdCBleGNlZWQgNTAgY2hhcmFjdGVycyddLFxuICB9LFxuICByb2xlOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGVudW06IHtcbiAgICAgIHZhbHVlczogWydVU0VSJywgJ0FETUlOJywgJ1NVUEVSX0FETUlOJ10sXG4gICAgICBtZXNzYWdlOiAne1ZBTFVFfSBpcyBub3QgYSB2YWxpZCByb2xlJyxcbiAgICB9LFxuICAgIHJlcXVpcmVkOiBbdHJ1ZSwgJ1JvbGUgaXMgcmVxdWlyZWQnXSxcbiAgfSxcbiAgaXNBY3RpdmU6IHtcbiAgICB0eXBlOiBCb29sZWFuLFxuICAgIGRlZmF1bHQ6IHRydWUsXG4gIH0sXG4gIGZhaWxlZExvZ2luQXR0ZW1wdHM6IHtcbiAgICB0eXBlOiBOdW1iZXIsXG4gICAgZGVmYXVsdDogMCxcbiAgfSxcbiAgbGFzdExvZ2luOiB7XG4gICAgdHlwZTogRGF0ZSxcbiAgICBkZWZhdWx0OiBudWxsLFxuICB9LFxuICBwYXNzd29yZENoYW5nZWRBdDoge1xuICAgIHR5cGU6IERhdGUsXG4gICAgZGVmYXVsdDogRGF0ZS5ub3csXG4gIH0sXG4gIHJlc2V0UGFzc3dvcmRUb2tlbjogU3RyaW5nLFxuICByZXNldFBhc3N3b3JkRXhwaXJlczogRGF0ZSxcbn0sIHtcbiAgdGltZXN0YW1wczogdHJ1ZSxcbiAgdG9KU09OOiB7XG4gICAgdHJhbnNmb3JtOiBmdW5jdGlvbihkb2MsIHJldCkge1xuICAgICAgcmV0LmlkID0gcmV0Ll9pZC50b1N0cmluZygpO1xuICAgICAgZGVsZXRlIHJldC5faWQ7XG4gICAgICBkZWxldGUgcmV0Ll9fdjtcbiAgICAgIGRlbGV0ZSByZXQucGFzc3dvcmQ7XG4gICAgICBkZWxldGUgcmV0LnJlc2V0UGFzc3dvcmRUb2tlbjtcbiAgICAgIGRlbGV0ZSByZXQucmVzZXRQYXNzd29yZEV4cGlyZXM7XG4gICAgICByZXR1cm4gcmV0O1xuICAgIH1cbiAgfVxufSk7XG5cbi8vIEFkZCBpbmRleCBmb3IgZW1haWwgYW5kIHVzZXJuYW1lXG5Vc2VyU2NoZW1hLmluZGV4KHsgZW1haWw6IDEgfSwgeyB1bmlxdWU6IHRydWUgfSk7XG5Vc2VyU2NoZW1hLmluZGV4KHsgdXNlcm5hbWU6IDEgfSwgeyB1bmlxdWU6IHRydWUgfSk7XG5cbi8vIFByZS1zYXZlIG1pZGRsZXdhcmUgdG8gaGFzaCBwYXNzd29yZFxuVXNlclNjaGVtYS5wcmUoJ3NhdmUnLCBhc3luYyBmdW5jdGlvbihuZXh0KSB7XG4gIC8vIE9ubHkgaGFzaCB0aGUgcGFzc3dvcmQgaWYgaXQgaGFzIGJlZW4gbW9kaWZpZWQgKG9yIGlzIG5ldylcbiAgaWYgKCF0aGlzLmlzTW9kaWZpZWQoJ3Bhc3N3b3JkJykpIHJldHVybiBuZXh0KCk7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBzYWx0ID0gYXdhaXQgYmNyeXB0LmdlblNhbHQoMTApO1xuICAgIHRoaXMucGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuaGFzaCh0aGlzLnBhc3N3b3JkLCBzYWx0KTtcbiAgICBuZXh0KCk7XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICBuZXh0KGVycm9yKTtcbiAgfVxufSk7XG5cbi8vIE1ldGhvZCB0byBjb21wYXJlIHBhc3N3b3Jkc1xuVXNlclNjaGVtYS5tZXRob2RzLmNvbXBhcmVQYXNzd29yZCA9IGFzeW5jIGZ1bmN0aW9uKGNhbmRpZGF0ZVBhc3N3b3JkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgYmNyeXB0LmNvbXBhcmUoY2FuZGlkYXRlUGFzc3dvcmQsIHRoaXMucGFzc3dvcmQpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHRocm93IGVycm9yO1xuICB9XG59O1xuIl0sIm5hbWVzIjpbIlNjaGVtYSIsInZhbGlkYXRvciIsImJjcnlwdCIsIlVzZXJTY2hlbWEiLCJ1c2VybmFtZSIsInR5cGUiLCJTdHJpbmciLCJyZXF1aXJlZCIsInVuaXF1ZSIsInRyaW0iLCJtaW5sZW5ndGgiLCJtYXhsZW5ndGgiLCJ2YWxpZGF0ZSIsInZhbHVlIiwidGVzdCIsIm1lc3NhZ2UiLCJlbWFpbCIsImxvd2VyY2FzZSIsImlzRW1haWwiLCJwYXNzd29yZCIsImxlbmd0aCIsIm5hbWUiLCJyb2xlIiwiZW51bSIsInZhbHVlcyIsImlzQWN0aXZlIiwiQm9vbGVhbiIsImRlZmF1bHQiLCJmYWlsZWRMb2dpbkF0dGVtcHRzIiwiTnVtYmVyIiwibGFzdExvZ2luIiwiRGF0ZSIsInBhc3N3b3JkQ2hhbmdlZEF0Iiwibm93IiwicmVzZXRQYXNzd29yZFRva2VuIiwicmVzZXRQYXNzd29yZEV4cGlyZXMiLCJ0aW1lc3RhbXBzIiwidG9KU09OIiwidHJhbnNmb3JtIiwiZG9jIiwicmV0IiwiaWQiLCJfaWQiLCJ0b1N0cmluZyIsIl9fdiIsImluZGV4IiwicHJlIiwibmV4dCIsImlzTW9kaWZpZWQiLCJzYWx0IiwiZ2VuU2FsdCIsImhhc2giLCJlcnJvciIsIm1ldGhvZHMiLCJjb21wYXJlUGFzc3dvcmQiLCJjYW5kaWRhdGVQYXNzd29yZCIsImNvbXBhcmUiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/models/schemas/UserSchema.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/next-auth","vendor-chunks/@babel","vendor-chunks/validator","vendor-chunks/jose","vendor-chunks/openid-client","vendor-chunks/uuid","vendor-chunks/oauth","vendor-chunks/@panva","vendor-chunks/yallist","vendor-chunks/preact-render-to-string","vendor-chunks/oidc-token-hash","vendor-chunks/bcryptjs","vendor-chunks/preact","vendor-chunks/object-hash","vendor-chunks/cookie"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=%2FUsers%2Ffrederickdineen%2FDesktop%2Fdevoapp%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ffrederickdineen%2FDesktop%2Fdevoapp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();